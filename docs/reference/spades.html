<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Run a spatial discrete event simulation — spades • SpaDES.core</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Run a spatial discrete event simulation — spades" />

<meta property="og:description" content="Here, we implement a simulation in a more modular fashion so it's easier to add
submodules to the simulation. We use S4 classes and methods, and use `data.table`
instead of `data.frame` to implement the event queue (because it is much faster)." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-58633549-6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-58633549-6');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SpaDES.core</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/i-introduction.html">01 Introduction to `SpaDES`</a>
    </li>
    <li>
      <a href="../articles/ii-modules.html">02 Building modules in `SpaDES`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/PredictiveEcology/SpaDES.core">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run a spatial discrete event simulation</h1>
    <small class="dont-index">Source: <a href='https://github.com/PredictiveEcology/SpaDES.core/blob/master/R/simulation-spades.R'><code>R/simulation-spades.R</code></a></small>
    <div class="hidden name"><code>spades.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Here, we implement a simulation in a more modular fashion so it's easier to add
submodules to the simulation. We use S4 classes and methods, and use `data.table`
instead of `data.frame` to implement the event queue (because it is much faster).</p>
    
    </div>

    <pre class="usage"><span class='fu'>spades</span>(<span class='no'>sim</span>, <span class='kw'>debug</span> <span class='kw'>=</span> <span class='fu'>getOption</span>(<span class='st'>"spades.debug"</span>), <span class='kw'>progress</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='no'>cache</span>,
  <span class='kw'>.plotInitialTime</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>.saveInitialTime</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>notOlderThan</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>...</span>)

<span class='co'># S4 method for simList,ANY,ANY,missing</span>
<span class='fu'>spades</span>(<span class='no'>sim</span>,
  <span class='kw'>debug</span> <span class='kw'>=</span> <span class='fu'>getOption</span>(<span class='st'>"spades.debug"</span>), <span class='kw'>progress</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='no'>cache</span>,
  <span class='kw'>.plotInitialTime</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>.saveInitialTime</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>notOlderThan</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>...</span>)

<span class='co'># S4 method for ANY,ANY,ANY,logical</span>
<span class='fu'>spades</span>(<span class='no'>sim</span>, <span class='kw'>debug</span> <span class='kw'>=</span> <span class='fu'>getOption</span>(<span class='st'>"spades.debug"</span>),
  <span class='kw'>progress</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='no'>cache</span>, <span class='kw'>.plotInitialTime</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>.saveInitialTime</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>notOlderThan</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>sim</th>
      <td><p>A <code>simList</code> simulation object, generally produced by <code>simInit</code>.</p></td>
    </tr>
    <tr>
      <th>debug</th>
      <td><p>Optional logical flag or character vector indicating what to print to
console at each event. See details.
Default is to use the value in <code>getOption("spades.debug")</code>.</p></td>
    </tr>
    <tr>
      <th>progress</th>
      <td><p>Logical (<code>TRUE</code> or <code>FALSE</code> show a graphical progress bar),
character (<code>"graphical"</code>, <code>"text"</code>) or numeric indicating
the number of update intervals to show in a graphical progress bar.</p></td>
    </tr>
    <tr>
      <th>cache</th>
      <td><p>Logical. If <code>TRUE</code>, then the <code>spades</code> call will be cached.
This means that if the call is made again with the same simList,
then `spades`` will return the return value from the previous run
of that exact same simList. Default <code>FALSE</code>. See Details.
See also the vignette on caching for examples.</p></td>
    </tr>
    <tr>
      <th>.plotInitialTime</th>
      <td><p>Numeric. Temporarily override the <code>.plotInitialTime</code>
parameter for all modules. See Details.</p></td>
    </tr>
    <tr>
      <th>.saveInitialTime</th>
      <td><p>Numeric. Temporarily override the <code>.plotInitialTime</code>
parameter for all modules. See Details.</p></td>
    </tr>
    <tr>
      <th>notOlderThan</th>
      <td><p>Date or time. Passed to <code><a href='http://reproducible.predictiveecology.org/reference/cache.html'>reproducible::Cache</a></code> to update the cache.
Default is <code>NULL</code>, meaning don't update the cache.
If <code>Sys.time()</code> is provided, then it will force a recache,
i.e., remove old value and replace with new value.
Ignored if <code>cache</code> is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Any. Can be used to make a unique cache identity, such as "replicate = 1".
This will be included in the <code>Cache</code> call, so will be unique
and thus <code>spades</code> will not use a cached copy as long as
anything passed in <code>...</code> is unique, i.e., not cached previously.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Invisibly returns the modified <code>simList</code> object.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The is the workhorse function in the SpaDES package. It runs simulations by
implementing the rules outlined in the <code>simList</code>.</p>
<p>This function gives simple access to two sets of module parameters:
<code>.plotInitialTime</code> and with <code>.plotInitialTime</code>. The primary use of
these arguments is to temporarily turn off plotting and saving. "Temporary"
means that the <code>simList</code> is not changed, so it can be used again with
the simList values reinstated. To turn off plotting and saving, use
<code>.plotInitialTime = NA</code> or <code>.saveInitialTime = NA</code>. NOTE: if a
module did not use <code>.plotInitialTime</code> or <code>.saveInitialTime</code>, then
these arguments will not do anything.</p>
<p>If <code>cache</code> is TRUE, this allows for a seamless way to "save" results
of a simulation. The  user does not have to intentionally do any saving manually.
Instead, upon a call to <code>spades</code> in which the simList is identical,
the function will simply return the result that would have come if it had
been rerun. Use this with caution, as it will return exactly the result from
a previous run, even if there is stochasticity internally.
Caching is only based on the input simList. See also <code>experiment</code> for
the same mechanism, but it can be used with replication.
See also the vignette on caching for examples.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The debug option is primarily intended to facilitate building simulation
models by the user.
Will print additional outputs informing the user of updates to the values of
various <code>simList</code> slot components.
See <a href='https://github.com/PredictiveEcology/SpaDES/wiki/Debugging'>https://github.com/PredictiveEcology/SpaDES/wiki/Debugging</a> for details.</p>
    
    <h2 class="hasAnchor" id="debug"><a class="anchor" href="#debug"></a><code>debug</code></h2>

    
    <p>If <code>debug</code> is specified and is not <code>FALSE</code>, 2 things will happen:
1) there can be messages sent to console, such as events as they pass by, and
2) (experimental still) if there is an error, it will attempt to open a browser
in the event where the error occurred. You can edit, and then press <code>c</code> to continue
or <code>Q</code> to quit, plus all other normal interactive browser tools.
<code>c</code> will trigger a reparse and events will continue as scheduled, starting
with the one just edited. There may be some unexpected consequences if the
<code>simList</code> objects had already been changed before the error occurred.
<code>debug</code> can be a logical or character vector.</p>
<p>If not specified in the function call, the package
option <code>spades.debug</code> is used. The following
options for debug are available:</p>
<table class='table'>
<tr><td><code>TRUE</code></td><td>the event immediately following will be printed as it
runs (equivalent to <code><a href='simList-accessors-events.html'>current(sim)</a></code>).</td></tr>
<tr><td>function name (as character string)</td><td>If a function, then it will be run on the
                                           simList, e.g., "time" will run
                                           <code>time(sim)</code> at each event.</td></tr>
<tr><td>moduleName (as character string)</td><td>All calls to that module will be entered
                                        interactively</td></tr>
<tr><td>eventName (as character string)</td><td>All calls that have that event name (in any module)
                                       will be entered interactively</td></tr>
<tr><td><code>c(&lt;moduleName&gt;, &lt;eventName&gt;)</code></td><td>Only the event in that specified module
                                            will be entered into.</td></tr>
<tr><td>Any other R expression</td><td>Will be evaluated with access to the simList as 'sim'.
                               If this is more than one character string, then all will
                               be printed to the screen in their sequence.</td></tr>
<tr><td></td><td><code>TRUE</code></td></tr>
</table>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Matloff, N. (2011). The Art of R Programming (ch. 7.8.3).
            San Fransisco, CA: No Starch Press, Inc..
            Retrieved from <a href='https://www.nostarch.com/artofr.htm'>https://www.nostarch.com/artofr.htm</a></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='SpaDES.core-package.html'>SpaDES.core-package</a></code>,
<code><a href='experiment.html'>experiment</a></code> for using replication with <code>spades</code>,
<code><a href='simInit.html'>simInit</a></code>, and the caching vignette (very important for reproducibility):
<a href='https://CRAN.R-project.org/package=SpaDES/vignettes/iii-cache.html'>https://CRAN.R-project.org/package=SpaDES/vignettes/iii-cache.html</a> which
uses <code><a href='http://reproducible.predictiveecology.org/reference/cache.html'>Cache</a></code>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='no'>mySim</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='simInit.html'>simInit</a></span>(
 <span class='kw'>times</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>start</span> <span class='kw'>=</span> <span class='fl'>0.0</span>, <span class='kw'>end</span> <span class='kw'>=</span> <span class='fl'>2.0</span>, <span class='kw'>timeunit</span> <span class='kw'>=</span> <span class='st'>"year"</span>),
 <span class='kw'>params</span> <span class='kw'>=</span> <span class='fu'>list</span>(
   <span class='kw'>.globals</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>stackName</span> <span class='kw'>=</span> <span class='st'>"landscape"</span>, <span class='kw'>burnStats</span> <span class='kw'>=</span> <span class='st'>"nPixelsBurned"</span>)
 ),
 <span class='kw'>modules</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='st'>"randomLandscapes"</span>, <span class='st'>"fireSpread"</span>, <span class='st'>"caribouMovement"</span>),
 <span class='kw'>paths</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>modulePath</span> <span class='kw'>=</span> <span class='fu'>system.file</span>(<span class='st'>"sampleModules"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"SpaDES.core"</span>))
)
<span class='fu'>spades</span>(<span class='no'>mySim</span>)

<span class='co'># set default debug printing for the current session</span>
<span class='co'># setOption(spades.debug = TRUE)</span>

<span class='co'># Different debug options (overrides the package option 'spades.debug')</span>
<span class='fu'>spades</span>(<span class='no'>mySim</span>, <span class='kw'>debug</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>) <span class='co'># Fastest</span>
<span class='fu'>spades</span>(<span class='no'>mySim</span>, <span class='kw'>debug</span> <span class='kw'>=</span> <span class='st'>"simList"</span>)
<span class='fu'>spades</span>(<span class='no'>mySim</span>, <span class='kw'>debug</span> <span class='kw'>=</span> <span class='st'>"print(table(sim$landscape$Fires[]))"</span>)

<span class='co'># Can turn off plotting, and inspect the output simList instead</span>
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'>spades</span>(<span class='no'>mySim</span>, <span class='kw'>.plotInitialTime</span> <span class='kw'>=</span> <span class='fl'>NA</span>) <span class='co'># much faster</span>
<span class='fu'><a href='simList-accessors-events.html'>completed</a></span>(<span class='no'>out</span>) <span class='co'># shows completed events</span>

<span class='co'># use cache -- simInit should generally be rerun each time a spades call is made</span>
<span class='co'>#   to guarantee that it is identical. Here, run spades call twice, first</span>
<span class='co'>#   time to establish cache, second time to return cached result</span>
<span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='fl'>2</span>) {
 <span class='no'>mySim</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='simInit.html'>simInit</a></span>(
   <span class='kw'>times</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>start</span> <span class='kw'>=</span> <span class='fl'>0.0</span>, <span class='kw'>end</span> <span class='kw'>=</span> <span class='fl'>2.0</span>, <span class='kw'>timeunit</span> <span class='kw'>=</span> <span class='st'>"year"</span>),
   <span class='kw'>params</span> <span class='kw'>=</span> <span class='fu'>list</span>(
     <span class='kw'>.globals</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>stackName</span> <span class='kw'>=</span> <span class='st'>"landscape"</span>, <span class='kw'>burnStats</span> <span class='kw'>=</span> <span class='st'>"nPixelsBurned"</span>)
   ),
   <span class='kw'>modules</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='st'>"randomLandscapes"</span>, <span class='st'>"fireSpread"</span>, <span class='st'>"caribouMovement"</span>),
   <span class='kw'>paths</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='kw'>modulePath</span> <span class='kw'>=</span> <span class='fu'>system.file</span>(<span class='st'>"sampleModules"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"SpaDES.core"</span>))
 )
 <span class='fu'>print</span>(<span class='fu'>system.time</span>(<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'>spades</span>(<span class='no'>mySim</span>, <span class='kw'>cache</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)))
}
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#debug"><code>debug</code></a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Alex Chubaty and Eliot McIntire

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Alex M Chubaty, Eliot J B McIntire.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

